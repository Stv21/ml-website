<!DOCTYPE html>
<html>
<head>
    <title>MLR (housing.csv)</title>
    <meta charset="UTF-8">
</head>
<body>
<pre>
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
import numpy as np
from google.colab import drive # Added for Google Drive

# 1. Mount Google Drive and Load Data
drive.mount('/content/drive')

# --- IMPORTANT: Update this path if different! ---
file_path = "/content/drive/My Drive/housing.csv" 

try:
    df = pd.read_csv(file_path)
except FileNotFoundError:
    print(f"Error: File not found at {file_path}")
    print("Please update the 'file_path' variable to the correct location in your Google Drive.")
    exit()
except Exception as e:
    print(f"An error occurred: {e}")
    exit()

print("Data loaded successfully.")

# 2. Prepare Data
# Drop rows with any missing values for simplicity
df.dropna(inplace=True)

# Define feature columns
numeric_features = ['median_income', 'housing_median_age', 'total_rooms', 'population']
categorical_features = ['ocean_proximity']
target = 'median_house_value'

X = df[numeric_features + categorical_features]
y = df[target]

# 3. Preprocessing: One-Hot Encoding for Categorical Data
preprocessor = ColumnTransformer(
    transformers=[
        ('cat', OneHotEncoder(), categorical_features)
    ],
    remainder='passthrough' # Keep the numeric features as they are
)

X_processed = preprocessor.fit_transform(X)

# 4. Split Data
X_train, X_test, y_train, y_test = train_test_split(X_processed, y, test_size=0.2, random_state=42)

# 5. Initialize and Train Model
model = LinearRegression()
model.fit(X_train, y_train)

# 6. Get Results
feature_names = preprocessor.get_feature_names_out()
all_coeffs = list(zip(feature_names, model.coef_))

print(f"Model Intercept (β₀): {model.intercept_:.2f}")
print("\nModel Coefficients (β₁, β₂, ...):")
for name, coeff in all_coeffs:
    print(f"  {name}: {coeff:.2f}")

# 7. Evaluate Model
y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"\nModel Performance on Test Set:")
print(f"Mean Squared Error (MSE): {mse:.2f}")
print(f"R-squared (R²): {r2:.4f}")
</pre>
</body>
</html>
